# 🏪 玉子市场 Tamako Market

[![GitHub release](https://img.shields.io/github/v/release/yuzi83/st-tamako-market)](https://github.com/yuzi83/st-tamako-market/releases)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

SillyTavern 可爱风格悬浮窗扩展，用于捕获和管理特定标签内容。

## ✨ 功能特色

- 🎨 **四种可爱主题** - 玉子市场 / 海边小店 / 向日葵田 / 夜间模式
- 🔍 **智能搜索** - 支持 AM 编号和关键词搜索
- 🐔 **德拉小助手** - 可爱的状态提示语
- 📦 **库存管理** - 历史记录查看与管理
- 🧹 **选择性删除** - 批量清理不需要的记录
- 🏷️ **自定义标签** - 灵活配置捕获规则
- 🖱️ **自由拖拽** - 可调整窗口位置和大小
- 📱 **移动端支持** - 完美支持手机端触摸操作

## 📥 安装方法

### 方法一：URL 安装（推荐）

1. 打开 SillyTavern
2. 进入 **扩展** → **安装扩展**
3. 输入仓库地址：https://github.com/yuzi83/st-tamako-market
4. 点击安装，然后重启 SillyTavern

### 方法二：手动安装

1. [下载最新版本](https://github.com/yuzi83/st-tamako-market/releases)
2. 解压到 `SillyTavern/data/<user>/extensions/third-party/st-tamako-market/`
3. 重启 SillyTavern

## 🎯 使用方法

### 基本操作

1. 点击 **🏪 玉子市场** 按钮打开窗口
2. 扩展会自动捕获包含指定标签的用户消息
3. 在 **📦 库存** 中查看历史记录

### 窗口按钮说明

| 按钮 | 功能 |
|:----:|------|
| ➖ | 最小化窗口 |
| 🔍 | 扫描历史消息 |
| 🧹 | 进入删除模式 |
| 🎨 | 切换主题 |
| ✖ | 关闭窗口 |

### 拖拽功能

- **窗口拖拽**：拖拽窗口标题栏可移动窗口位置
- **按钮拖拽**：拖拽"玉子市场"按钮可移动按钮位置
- **窗口缩放**：拖拽窗口右边/下边/右下角可调整大小
- **位置记忆**：所有位置会自动保存

### 默认捕获标签

- `recall`
- `scene_direction`

可在设置中自定义添加其他标签。

## 🎨 主题预览

| 主题 | 描述 |
|------|------|
| 🌸 玉子市场 | 粉色可爱风（默认） |
| 🌊 海边小店 | 蓝色清新风 |
| 🌻 向日葵田 | 黄色活力风 |
| 🌙 夜间模式 | 深色护眼风 |

## ⚙️ 设置选项

| 选项 | 说明 | 默认值 |
|------|------|--------|
| 启用扩展 | 开启/关闭扩展功能 | ✅ 开启 |
| 自动捕获 | 自动捕获新消息 | ✅ 开启 |
| 捕获标签 | 要捕获的 XML 标签名 | recall, scene_direction |
| 扫描消息数 | 每次扫描的最大消息数 | 50 |
| 最大存储数 | 库存最大保存记录数 | 50 |

## 🐔 德拉小助手

德拉会在不同状态下显示可爱的提示语：

- 💤 **空闲时**：「德拉在打瞌睡...」
- ✨ **新货到**：「德拉发现了新货！」
- 🔍 **搜索中**：「德拉正在努力搜寻...」
- 📦 **清理后**：「德拉帮你打包好了~」

## 🔧 兼容性

- SillyTavern 1.10.0 及以上版本
- 支持所有现代浏览器（Chrome、Firefox、Edge 等）
- 📱 支持手机端（Android / iOS）

## 📝 更新日志

### v2.1.4

- 🐛 修复内容区文字不自动换行的问题
- 🐛 修复滚动条被缩放手柄遮挡的问题（滚动条移至左侧）
- 💄 优化内容显示区域样式

### v2.1.2

- ✨ 新增手机端触摸拖拽窗口支持
- ✨ 新增手机端触摸缩放窗口支持
- ✨ 新增"玉子市场"按钮可拖拽功能
- ✨ 按钮和窗口位置自动保存
- ✨ 新增"重置按钮"功能
- 🐛 修复窗口层级问题（按钮始终在窗口之上）
- 🐛 修复重置位置不一致问题
- 🐛 修复窗口关闭后再打开位置不保持问题
- 💄 移动端UI适配优化
- 💄 增大触摸区域便于操作

### v2.0.0

- ✨ 新增四种可爱主题
- ✨ 新增智能搜索功能
- ✨ 新增德拉小助手提示
- ✨ 新增扫描数量限制设置
- ✨ 新增搜索词高亮显示
- 🐛 修复自动捕获偶尔失效的问题
- 🐛 修复历史记录重叠显示的问题
- 💄 优化 UI 设计和动画效果

## 📄 许可证

[MIT License](LICENSE)

---

<p align="center">
<i>德拉：欢迎光临玉子市场！🐔✨</i>
</p>
